<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‹œìŠ¤í…œ ì»´í¬ë„ŒíŠ¸ ì•„í‚¤í…ì²˜</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 2.2em;
        }
        .diagram-container {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid #e9ecef;
        }
        .component-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .component-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            border-left: 5px solid #007bff;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .component-title {
            color: #007bff;
            font-size: 1.3em;
            margin-bottom: 10px;
            font-weight: bold;
        }
        .file-structure {
            background: #e9ecef;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§© ì‹œìŠ¤í…œ ì»´í¬ë„ŒíŠ¸ ì•„í‚¤í…ì²˜</h1>
        
        <div class="diagram-container">
            <h3>ğŸ“ íŒŒì¼ êµ¬ì¡° ë° ëª¨ë“ˆ ê´€ê³„</h3>
            <div class="mermaid">
graph TB
    subgraph "í”„ë¡œì íŠ¸ ë£¨íŠ¸"
        ROOT["hvdc_marine_ingest/"]
    end
    
    subgraph "ë°ì´í„° ìˆ˜ì§‘ ê³„ì¸µ"
        NCM["ncm_web/<br/>ncm_selenium_ingestor.py<br/>ncm_web_ingestor.py"]
        CONN["src/marine_ops/connectors/<br/>stormglass.py<br/>open_meteo.py<br/>worldtides.py"]
    end
    
    subgraph "í•µì‹¬ ì²˜ë¦¬ ê³„ì¸µ"
        SCHEMA["src/marine_ops/core/<br/>schema.py<br/>units.py<br/>cache.py<br/>vector_db.py"]
        ERI["src/marine_ops/eri/<br/>compute.py"]
        DECISION["src/marine_ops/decision/<br/>fusion.py"]
    end
    
    subgraph "ì§ˆì˜ ì‘ë‹µ ê³„ì¸µ"
        QUERY["query_vec.py<br/>MarineQueryEngine"]
        HOOKS["agent_hooks.py<br/>Cursor Browser Controls"]
    end
    
    subgraph "ìë™í™” ê³„ì¸µ"
        SCRIPTS["scripts/<br/>generate_weather_report.py<br/>cron_automation.py<br/>demo_integrated.py"]
        CONFIG["config/<br/>settings.yaml<br/>eri_rules.yaml<br/>env_template"]
    end
    
    subgraph "ë°ì´í„° ì €ì¥ì†Œ"
        DATA["data/<br/>marine_*.csv"]
        REPORTS["reports/<br/>DEMO_*.json"]
        VECDB["marine_vec.db<br/>SQLite ë²¡í„° DB"]
    end
    
    ROOT --> NCM
    ROOT --> CONN
    ROOT --> SCHEMA
    ROOT --> ERI
    ROOT --> DECISION
    ROOT --> QUERY
    ROOT --> HOOKS
    ROOT --> SCRIPTS
    ROOT --> CONFIG
    
    NCM --> SCHEMA
    CONN --> SCHEMA
    SCHEMA --> ERI
    ERI --> DECISION
    DECISION --> VECDB
    QUERY --> VECDB
    SCRIPTS --> NCM
    SCRIPTS --> CONN
    SCRIPTS --> DATA
    SCRIPTS --> REPORTS
            </div>
        </div>

        <div class="component-grid">
            <div class="component-card">
                <div class="component-title">ğŸ” NCM ë°ì´í„° ìˆ˜ì§‘ê¸°</div>
                <p><strong>ì—­í• </strong>: NCM Al Bahar í•´ì–‘ ê´€ì¸¡ í˜ì´ì§€ì—ì„œ ì‹¤ì‹œê°„ ë°ì´í„° ìˆ˜ì§‘</p>
                <div class="file-structure">
ncm_web/
â”œâ”€â”€ ncm_selenium_ingestor.py
â”œâ”€â”€ ncm_web_ingestor.py
â””â”€â”€ __init__.py
                </div>
                <ul>
                    <li>Selenium WebDriverë¡œ ë™ì  í˜ì´ì§€ ì²˜ë¦¬</li>
                    <li>í…Œì´ë¸” ë°ì´í„° íŒŒì‹± ë° ì •ê·œí™”</li>
                    <li>ë‹¨ìœ„ ë³€í™˜ (ktâ†’m/s, ftâ†’m)</li>
                    <li>ë²¡í„° DB ìë™ ì €ì¥</li>
                </ul>
            </div>

            <div class="component-card">
                <div class="component-title">ğŸŒ API ì»¤ë„¥í„°</div>
                <p><strong>ì—­í• </strong>: ì™¸ë¶€ í•´ì–‘ ë‚ ì”¨ APIì™€ í†µì‹ </p>
                <div class="file-structure">
src/marine_ops/connectors/
â”œâ”€â”€ stormglass.py
â”œâ”€â”€ open_meteo.py
â”œâ”€â”€ worldtides.py
â””â”€â”€ __init__.py
                </div>
                <ul>
                    <li>Stormglass: ìƒìš© í•´ì–‘ API</li>
                    <li>Open-Meteo: ì˜¤í”ˆì†ŒìŠ¤ ë‚ ì”¨ API</li>
                    <li>WorldTides: ì¡°ì„ ë°ì´í„° API</li>
                    <li>ì—ëŸ¬ ì²˜ë¦¬ ë° ì¬ì‹œë„ ë¡œì§</li>
                </ul>
            </div>

            <div class="component-card">
                <div class="component-title">âš™ï¸ í•µì‹¬ ì²˜ë¦¬ ì—”ì§„</div>
                <p><strong>ì—­í• </strong>: ë°ì´í„° í‘œì¤€í™” ë° ë²¡í„° ì €ì¥</p>
                <div class="file-structure">
src/marine_ops/core/
â”œâ”€â”€ schema.py
â”œâ”€â”€ units.py
â”œâ”€â”€ cache.py
â””â”€â”€ vector_db.py
                </div>
                <ul>
                    <li>MarineDataPoint ìŠ¤í‚¤ë§ˆ ì •ì˜</li>
                    <li>SI ë‹¨ìœ„ ë³€í™˜</li>
                    <li>3ì‹œê°„ TTL ìºì‹œ</li>
                    <li>SQLite ë²¡í„° DB ê´€ë¦¬</li>
                </ul>
            </div>

            <div class="component-card">
                <div class="component-title">ğŸ“Š ERI ê³„ì‚° ì—”ì§„</div>
                <p><strong>ì—­í• </strong>: í™˜ê²½ ìœ„í—˜ ì§€ìˆ˜ ê³„ì‚° (0-100)</p>
                <div class="file-structure">
src/marine_ops/eri/
â”œâ”€â”€ compute.py
â””â”€â”€ __init__.py
                </div>
                <ul>
                    <li>íŒŒê³ , í’ì† ê¸°ë°˜ ìœ„í—˜ë„ ê³„ì‚°</li>
                    <li>ì„ê³„ê°’: íŒŒê³  1.5m, í’ì† 20kt</li>
                    <li>ê·œì¹™ ê¸°ë°˜ ì ìˆ˜ ë§¤í•‘</li>
                    <li>ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ ì§€ì›</li>
                </ul>
            </div>

            <div class="component-card">
                <div class="component-title">ğŸ¯ ì˜ˆë³´ ìœµí•© ì—”ì§„</div>
                <p><strong>ì—­í• </strong>: ë‹¤ì¤‘ ì†ŒìŠ¤ ì˜ˆë³´ í†µí•© ë° ìš´í•­ íŒì •</p>
                <div class="file-structure">
src/marine_ops/decision/
â”œâ”€â”€ fusion.py
â””â”€â”€ __init__.py
                </div>
                <ul>
                    <li>NCM 60% + ì‹œìŠ¤í…œ 40% ê°€ì¤‘ì¹˜</li>
                    <li>GO/CONDITIONAL/NO-GO íŒì •</li>
                    <li>ì‹ ë¢°ë„ â‰¥0.95 ìš”êµ¬</li>
                    <li>ì‹¤ì‹œê°„ ì•Œë¦¼ íŠ¸ë¦¬ê±°</li>
                </ul>
            </div>

            <div class="component-card">
                <div class="component-title">ğŸ¤– ì§ˆì˜ ì‘ë‹µ ì‹œìŠ¤í…œ</div>
                <p><strong>ì—­í• </strong>: ìì—°ì–´ ì§ˆì˜ ì²˜ë¦¬ ë° LLM ë¶„ì„</p>
                <div class="file-structure">
query_vec.py
agent_hooks.py
                </div>
                <ul>
                    <li>ìì—°ì–´ â†’ ë²¡í„° ë³€í™˜</li>
                    <li>KNN ìœ ì‚¬ë„ ê²€ìƒ‰</li>
                    <li>Cursor Browser Controls í›…</li>
                    <li>êµ¬ì¡°í™”ëœ ë‹µë³€ ìƒì„±</li>
                </ul>
            </div>

            <div class="component-card">
                <div class="component-title">â° ìë™í™” ìŠ¤ì¼€ì¤„ëŸ¬</div>
                <p><strong>ì—­í• </strong>: ì£¼ê¸°ì  ë°ì´í„° ìˆ˜ì§‘ ë° ë³´ê³ ì„œ ìƒì„±</p>
                <div class="file-structure">
scripts/
â”œâ”€â”€ generate_weather_report.py
â”œâ”€â”€ cron_automation.py
â”œâ”€â”€ demo_integrated.py
â””â”€â”€ test_vector_pipeline.py
                </div>
                <ul>
                    <li>3ì‹œê°„ë§ˆë‹¤ ë°ì´í„° ìˆ˜ì§‘</li>
                    <li>06:00/18:00 ë³´ê³ ì„œ ìƒì„±</li>
                    <li>Telegram/Email ì•Œë¦¼</li>
                    <li>í—¬ìŠ¤ì²´í¬ ë° ì—ëŸ¬ ë³µêµ¬</li>
                </ul>
            </div>

            <div class="component-card">
                <div class="component-title">âš™ï¸ ì„¤ì • ê´€ë¦¬</div>
                <p><strong>ì—­í• </strong>: ì‹œìŠ¤í…œ ì„¤ì • ë° ê·œì¹™ ê´€ë¦¬</p>
                <div class="file-structure">
config/
â”œâ”€â”€ settings.yaml
â”œâ”€â”€ eri_rules.yaml
â””â”€â”€ env_template
                </div>
                <ul>
                    <li>API í‚¤ ë° ì—”ë“œí¬ì¸íŠ¸</li>
                    <li>ERI ê³„ì‚° ê·œì¹™</li>
                    <li>ì„ê³„ê°’ ë° ê°€ì¤‘ì¹˜</li>
                    <li>ì•Œë¦¼ ì„¤ì •</li>
                </ul>
            </div>

            <div class="component-card">
                <div class="component-title">ğŸ’¾ ë°ì´í„° ì €ì¥ì†Œ</div>
                <p><strong>ì—­í• </strong>: ìˆ˜ì§‘ëœ ë°ì´í„° ë° ë²¡í„° ì €ì¥</p>
                <div class="file-structure">
data/
â”œâ”€â”€ marine_*.csv
â””â”€â”€ marine_vec.db

reports/
â””â”€â”€ DEMO_*.json
                </div>
                <ul>
                    <li>SQLite ë²¡í„° DB (384ì°¨ì›)</li>
                    <li>CSV í˜•íƒœ ì›ë³¸ ë°ì´í„°</li>
                    <li>JSON í˜•íƒœ ë³´ê³ ì„œ</li>
                    <li>ë©”íƒ€ë°ì´í„° ê´€ë¦¬</li>
                </ul>
            </div>
        </div>

        <div class="diagram-container">
            <h3>ğŸ”„ ë°ì´í„° í”Œë¡œìš° ì‹œí€€ìŠ¤</h3>
            <div class="mermaid">
sequenceDiagram
    participant U as ì‚¬ìš©ì
    participant S as ìŠ¤ì¼€ì¤„ëŸ¬
    participant N as NCM ìˆ˜ì§‘ê¸°
    participant A as API ì»¤ë„¥í„°
    participant E as ERI ì—”ì§„
    participant D as ìœµí•© ì—”ì§„
    participant V as ë²¡í„° DB
    participant Q as ì§ˆì˜ ì—”ì§„
    participant L as LLM
    
    Note over S: ë§¤ 3ì‹œê°„ë§ˆë‹¤ ì‹¤í–‰
    S->>N: ë°ì´í„° ìˆ˜ì§‘ ìš”ì²­
    N->>N: Selenium í¬ë¡¤ë§
    N->>A: ì™¸ë¶€ API í˜¸ì¶œ
    A->>N: í•´ì–‘ ë°ì´í„° ë°˜í™˜
    N->>E: ë°ì´í„° ì „ë‹¬
    E->>E: ERI ê³„ì‚° (0-100)
    E->>D: ìœ„í—˜ ì§€ìˆ˜ ì „ë‹¬
    D->>D: ë‹¤ì¤‘ ì†ŒìŠ¤ ìœµí•©
    D->>D: ìš´í•­ íŒì • (GO/COND/NO-GO)
    D->>V: ê²°ê³¼ ì €ì¥
    V->>V: ë²¡í„° ì„ë² ë”© ìƒì„±
    
    Note over U: ìì—°ì–´ ì§ˆì˜
    U->>Q: "AGI high tide RORO window"
    Q->>V: ë²¡í„° ê²€ìƒ‰
    V->>Q: ìœ ì‚¬ ë°ì´í„° ë°˜í™˜
    Q->>L: LLM ë¶„ì„ ìš”ì²­
    L->>Q: êµ¬ì¡°í™”ëœ ë‹µë³€
    Q->>U: ìš´í•­ ì¡°ê±´ ë¦¬í¬íŠ¸
            </div>
        </div>
    </div>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true
            },
            sequence: {
                useMaxWidth: true
            }
        });
    </script>
</body>
</html>
